{"name":"customer_flow","description":"","pipeline":{"version":"1.0","doc_type":"pipeline","app_data":{"shaperCreated":true,"replace_space_by_dot":true},"primary_pipeline":"pipeline1","pipelines":[{"id":"pipeline1","nodes":[{"id":"source1","app_data":{"sampling":{"type":"topRows","size":10000}},"data_asset":{"properties":{"row_start":"0","file_format":"parquet"},"ref":"data_asset.customer","app_data":{"dataset_name":"customer"}},"type":"binding","output":{"id":"source1output"}},{"id":"40988c30-88d2-4215-9fd1-6ff337c66947","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"splitColumn","code":"eval({if(\"t_bd2b7792_3eaa_4cd6_b7e5_de0a45383a9d\" %in% names(.)) stop(\"Referencing duplicate column 't_bd2b7792_3eaa_4cd6_b7e5_de0a45383a9d' in operation.\", call. = FALSE) else .})%>%tidyr::separate(`CUSTOMER_NAME`, into = c('NAME_1','NAME_2'), remove = FALSE, extra = 'merge', fill = 'right')","args":{"column":"CUSTOMER_NAME","type":"default","value":"","removeAllColumns":false,"extra":"merge","fill":"right","newColumnNames":"NAME_1,NAME_2","version":3}}},"parameters":{"FREEFORM_CODE":"mutate(`t_bd2b7792_3eaa_4cd6_b7e5_de0a45383a9d` = splitSep(`CUSTOMER_NAME`, NA, 2, 'merge', 'right'))%>%mutate(`NAME_1` = t_bd2b7792_3eaa_4cd6_b7e5_de0a45383a9d[[0]],`NAME_2` = t_bd2b7792_3eaa_4cd6_b7e5_de0a45383a9d[[1]])%>%select(0:`CUSTOMER_NAME`, `NAME_1`,`NAME_2` , everything())%>%select(-c(`t_bd2b7792_3eaa_4cd6_b7e5_de0a45383a9d`))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"source1","port_id_ref":"source1output"}]}],"outputs":[{"id":"outputPort1"}]},{"data_asset":{"properties":{"file_format":"csv","mode":"overwrite","first_line_header":true,"name":"customer_shaped"},"app_data":{"project_name":"deltalake_example","targetType":"dataAsset"}},"id":"target1","type":"binding","input":{"id":"targetInput1","link":{"node_id_ref":"40988c30-88d2-4215-9fd1-6ff337c66947","port_id_ref":"outputPort1"}}}],"runtime":"Spark"}]}}